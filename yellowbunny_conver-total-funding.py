import re
import numpy as np


def convert_to_int(word):    
    '''pattern below splits word in three group:         
        first: dolar sign, 
        second: value even with numbers after dot, 
        third: M or B magnitude. Note if we don't have magnitude skip this step'''
    if word in ['', np.nan, str(np.nan)]:
        return np.nan
    sizes = {'M':10**6, 'B':10**9, 'K':10**3}
    patt = r'([$])?([0-9.,]+)([A-Za-z])?'    
    search_obj = re.search(patt, word)
    # unpack data
    value, magnitude = search_obj.group(2), search_obj.group(3)
#     display(value, magnitude)
    # if we have comma in value replace to dot
    if ',' in value:
        value = value.replace(',', '.')
    value = float(value)
    # if we have detected magnitude multiply value by magnitude
    if magnitude:
#         # check if magnitude are allow 
        try:
            value*= sizes[magnitude]        
        except:            
            raise KeyError('Wrong magnitude. Allow M or B')
        return int(value)
    else:
        return int(value)
    
l = ['$42M', '$56.5M', '$107.2M', '$13M', 'nan', '$252.5M', '$382.1M',
       '$1.3B', '$4.2M', '$101.3M', '$18.2M', '$138.9M', '$50.9M',
       '$149.8M', '$66M', '$658.7M', '$1000M', '$297.5M', '$183M',
       '$172.6M', '$75.5M', '$1.8B', '$220M', '$266M', '$170M', '$143.5M',
       '$429.5M', '$2.6B', '$75M', '$135.3M', '$122M', '$143M', '$53.3M',
       '$309.3M', '$298.1M', '$89.6M', '$48.3M', '$228.5M', '$8.2M',
       '$1B', '$181.7M', '$1.1B', '$34.1M', '$574.7M', '$368M', '$1.5B',
       '$23.1M', '$110M', '$14M', '$129M', '$1.7B', '$16M', '$100.3M',
       '$132M', '$81.5M', '$190M', '$687.5M', '$73.5M', '$260M',
       '$138.4M', '$531M', '$6.5M', '$175.5M', '$945M', '$36.1M',
       '$253.1M', '$30M', '$209M', '$22M', '$4.8M', '$134.5M', '$126.3M',
       '$27.5M', '$250M', '$8M', '$13.2M', '$293.8M', '$405M', '$122.6M',
       '$575M', '$295.7M', '$11.4M', '$205M', '$263.2M', '$216M',
       '$232.3M', '$32M', '$191.1M', '$8.5M', '$180M', '$132.9M',
       'Â£160M', '$378M', '$101.1M', '$954M', '$50M', '$95M', '$380M',
       '$145M', '$338.6M', '$7.5M', '$173M', '$53M', '$252M', '$100M',
       '$59.4M', '$239M', '$350M', '$201M', '$145.8M', '$192.8M', '$27M',
       '$5M', '$71M', '$33M', '$20M', '$126M', '$65M', '$308M', '$133.8M',
       '$28.3M', '$152M', '$118M', 'Â£1B', '$270.5M', '$37.3M', '$151M',
       '$446.2M', '$328M', '$516.5M', 'SEK2B', '$62M', '$410M', '$88.4M',
       '$1.6B', 'â‚¬95.1M', '$24.5M', '$35M', '$187.4M', '$282.5M',
       '$25M', '$192.9M', '$118.1M', '$343M', 'â‚¬150M', '$63.2M',
       '$60.3M', '$49.5M', '$356M', '$263.3M', 'Â£140M', 'Â£100M', '$59M',
       '$135M', '$495M', '$620M', '$480M', '$90M', '$563M', '$144.4M',
       '$52.6M', '$159M', '$832.5M', '$144.1M', '$37.4M', '$37.5M',
       '$384.8M', '$381M', '$58.2M', '$175M', '$60M', '$11.7M', '$55.6M',
       'â‚¬700M', '$425M', '$125.9M', '$18.6M', '$296M', '$110.9M',
       '$400M', '$29.6M', '$541M', '$234.1M', '$35.3M', '$212.3M',
       '$77.6M', '$204.3M', '$119.7M', '$158M', '$281.7M', '$193.7M',
       '$17.6M', '$96M', '$6.7M', '$28M', '$90.5M', '$61.7M', '$57M',
       '$150M', '$69.9M', '$125M', '$197M', '$37M', '$16.7M', '$165M',
       '$204M', '$210M', '$362M', '$388M', '$20.1M', '$351.8M', '$1.5M',
       '$270M', '$61.5M', '$117M', '$82M', '$25.3M', '$30.6M', '$25.9M',
       '$18.3M', '$230.2M', 'â‚¬115M', 'â‚¬172.4M', '$121.3M', '$15.1M',
       '$66.5M', '$275M', '$186.4M', '$12.1M', '$168M', '$49.7M', '$500M',
       '$17.4M', '$310M', '$18.5M', '$8.8M', '$160.2M', '$2.5B', '$69.6M',
       '$185M', '$4065M', '$452M', '$93M', '$109.1M', '$122.3M', '$142M',
       '$19M', '$207M', '$21.9M', '$20.9M', '$3.1M', '$124M', '$200M',
       '$202M', '$26M', '$282M', '$27.2M', '$1.2B', '$140.2M', '$21M',
       '$168.8M', '$230M', '$46.9M', '$618M', '$146.8M', '$40M',
       '$363.5M', '$158.1M', '$504.4M', '$125.7M', '$622.4M', '$790M',
       '$285M', '$222.5M', '$10M', '$171.6M', '$120.7M', '$107M', '$375M',
       '$300M', '$365M', '$41M', '$105.9M', '$102M', '$142.3M', '$141.3M',
       '$237.6M', '$30.4M', '$24.9M', '$2B', '$22.8M', '$18.9M',
       '$148.3M', 'Â£666.8M', '$124.3M', '$5.7M', '$49.3M', '$9.9M',
       '$150.7M', '$1.3M', '$259.8M', '$77M', 'NOK1.3B', '$87.6M',
       '$134.2M', '$397.7M', '$84M', '$223.2M', '$124.5M', 'CA$123M',
       '$19.7M', '$597M', '$61.4M', '$75.1M', '$186.6M', '$925M',
       '$435.6M', '$483M', '$160M', '$128M', '$34M', '$448.5M', '$157.8M',
       '$398.7M', '$166.3M', '$207.7M', '$43.7M', '$283.5M', '$71.1M',
       '$159.7M', '$3.8M', '$339.4M', '$167.7M', '$255.9M', '$358M',
       '$264M', '$199.9M', '$200.1M', '$55.5M', '$81M', '$2.3B',
       '$320.4K', '$78M', '$309M', '$56.1M', '$549M', '$327.5M', '$86M',
       '$126.4M', '$23.5M', '$229.6M', '$224.3M', '$279.3M', '$61M',
       '$61.1M', '$624.5M', '$208.3M', '$12.9M', '$133.3M', '$354.8M',
       '$78.8M', '$264.7M', '$159.1M', '$252.1M', '$819.8M', '$1.9M',
       '$76.4M', '$136.5M', '$179M', '$6M', '$102.1M', '$47M', '$183.9M',
       '$156.4M', '$52.9M', '$226.8M', '$840M', '$5.3M', '$165.8M',
       '$36.3M', '$57.5M', '$107.5M', '$111.7M', '$170.7M', '$221.2M',
       '$9.4M', '$330M', '$48.6M', '$58.3M', '$142.1M', '$180.3M',
       '$238.3M', '$91.1M', '$227.8M', '$12M', '$88.9M', '$60.1M',
       '$721.3M', '$19.8M', '$54M', '$242.6M', '$286M', '$22.7M',
       '$496.9M', '$123.5M', '$157.5M', '$155M', '$119M', '$7.7M',
       '$107.1M', '$244M', '$135.6M', '$119.3M', '$103.8M', '$46.7M',
       '$175.9M', '$3.6B', '$388.6M', '$15.3M', '$11M', '$41.6M',
       '$12.7M', '$27.4M', '$531.8M', '$240M', '$93.8M', '$106M',
       '$281.5M', '$116M', '$654.5M', '$103.6M', '$28.8M', 'A$292M',
       '$443.3M', '$44.1M', '$33.1M', '$391.2M', '$256.4M', '$217.6M',
       '$772M', '$85.8M', '$295.1M', '$66.7M', '$29.5M', '$84.1M',
       '$30.3M', '$29.3M', '$9.1M', '$996M', '$34.2M', '$52.5M', '$48.7M',
       '$46.1M', '$27.6M', '$390.4M', '$133.2M', '$340M', '$103M',
       '$3.6M', '$56M', 'â‚¬5.7M', '$112.5M', '$13.8M', '$274M',
       '$544.8M', '$6.8M', '$80M', '$38.7M', '$439M', '$10.3M', '$9.6M',
       '$74M', '$2.3M', '$49M', '$61.9M', '$64.8M', '$85M', '$15M',
       '$175.4M', '$76.3M', '$34.7M', '$68.1M', '$175.2M', '$17.1M',
       '$15.6M', '$220.1M', '$88.2M', '$23.9M', 'â‚¬10M', '$79.1M',
       '$190.6M', '$1.4M', '$4M', '$650.2K', '$20.5M', '$105M', '$5.4M',
       '$5.6M', '$30.5M', '$100.9M', '$94.3M', '$4.1M', '$46M', '$15.1K',
       '$11.2M', '$2.4B', '$18M', '$2.4M', '$45M', '$530M', '$415M',
       '$247M', '$14.9M', '$319M', '$31M', '$43.1M', '$47.1M', '$100.2M',
       '$321M', '$226.5M', '$627.8M', '$1.6M', '$23M', '$69.8M', '$114M',
       '$46.3M', '$34.5M', '$10.9M', 'â‚¬138M', '$68M', '$4.3M', '$95.5M',
       '$10.4K', '$4.7M', '$206.2M', '$20.6M', 'â‚¬43.6M', '$7M', '$750K',
       '$70M', '$373M', '$35.1M', '$235.9M', '$48.2M', '$58.1M', '$423M',
       '$123.2M', '$119.1M', '$42.9M', '$20.3M', '$163.3M', '$36M',
       '$16.9M', '$32.3M', '$34.4M', '$147M', '$51.5M', '$436.2M', '$2M',
       '$33.4M', '$127.5M', '$9M', '$171M', '$257M', '$70.5M', '$23.7M',
       '$43.3M', '$393.5M', '$174M', '$60.8M', '$12.3M', '$599.5K',
       '$218M', '$28.2M', '$10.5M', '$12.6M', '$38M', '$104.3M',
       '$103.3M', '$222M', '$33.8M', '$246.2M', '$2.5M', '$7.1M',
       '$19.2M', '$39M', '$58M', '$14.7M', '$33.5M', '$24.4M', '$5.2M',
       '$3M', '$41.7M', '$217.5M', '$8.3M', '$15.2M', '$149.3M', '$45.4M',
       '$31.3M', '$178M', '$27.9M', '$40.5M', '$47.5M', '$1.2M', '$52M',
       '$215M', '$181.5M', '$12.5M', '$38.2M', '$280.2M', '$130M',
       '$31.8M', '$6.6M', '$76.6M', '$15.9M', '$44.7M', '$17.7M',
       '$80.9M', '$119.9M', 'â‚¬25M', '$17M', '$74.8M', '$13.1M',
       '$28.5M', '$2.2M', '$81.3M', '$11.3M', '$36.5M', '$191.6M',
       '$25.8M', '$2.9M', '$2.1M', '$72.5M', '$72M', '$105.1M', '$57.9M',
       '$82.5M', '$4.5M', '$35.6M', '$284M', '$22.3M', '$137M', '$134.3M',
       '$36.7M', '$4.9M', '$83.1M', '$14.5M', '$75.7M', '$7.4M', '$80.6M',
       '$265.5M', '$57.4M', '$30.2M', '$2.6M', '$54.5M', '$25.1M', '$43M',
       '$47.4M', '$16.8M', '$67.3M', '$11.1M', '$56.2M', '$56.8M',
       '$31.7M', '$32.5M', '$66.1M', '$18.8M', '$25.7M', '$53.5M',
       '$6.9M', '$88M', '$111.5M', '$24M', '$502.5M', '$106.9M', '$51.1M',
       '$59.1M', '$407.5M', '$69.1M', '$72.2M', '$33.9M', '$14.8M',
       '$29.7M', '$307.3M', '$105.5M', '$69.7M', '$39.9M', '$76M',
       '$228.7M', '$36.9M', '$25.5M', 'DKK185M', '$121M', '$51.8M',
       '$139M', '$132.1M', '$300K', '$47.8M', '$111.6M', '$94.2M',
       '$13.9M', '$31.2M', '$520M', '$248.3M', '$45.3M', '$41.3M',
       '$57.3M', '$29.2M', '$22.6M', '$54.8M', '$24.6M', '$16.5M',
       '$58.4M', '$21.5M', '$131.5M', '$590.5K', '$51M', '$439.1M',
       '$16.2M', '$42.7M', '$153.3M', '$212.8M', '$68.5M', '$14.4M',
       '$41.5M', '$36.6M', '$62.1M', '$66.2M', '$98.6M', '$28.4M',
       '$19.9M', '$44M', '$83M', '$55M', '$3.9M', '$42.3M', '$508.5M',
       '$231.9M', '$32.8M', '$33.2M', '$134.4M', '$21.7M', '$44.8M',
       '$97.3M', '$64M', '$191M', '$11.8M', '$96.5M', '$23.6M', '$136M',
       '$89M', '$550.1M', '$67.5M', '$37.1M', '$38.4M', '$60.4M',
       '$110.5M', '$99.8M', '$29.8M', '$164M', '$58.9M', '$490.7M',
       '$206.1M', '$525.2M', '$35.8M', '$3.7M', '$20.7M', '$24.2M',
       '$212.5M', '$133.6M', '$235.5M', '$21.4M', '$63.1M', '$194M',
       '$16.1M', '$19.5M', '$203.1M', '$114.7M', '$62.6M', '$52.8M',
       '$57.8M', '$140M', 'Â£4.9B', '$190.1M', '$75.4M', '$45.5M',
       '$9.8M', '$541.7M', '$35.9M', '$82.4M', '$20.4M', '$146M',
       '$239.3M', '$307.9M', '$56.3M', '$55.8M', '$220.9K', '$8.7M',
       '$1.1M', '$88.5M', '$21.6M', '$84.3M', '$108M', '$53.1M', '$93.3M',
       '$19.4M', '$160.4M', '$9.2M', '$11.9M', '$111M', '$156.3M',
       '$98.5M', '$236.5M', '$470M', '$26.6M', '$40.2M', '$40.4M',
       '$79.7M', '$850M', '$347.1M', '$975M', '$522.2M', '$112.6M',
       '$86.6M', '$175.6M', '$229M', '$434.8M', '$118.5M', '$482M',
       '$532.1M', '$179.7M', '$574.1M', '$22.9M', '$10.6M', '$10.1M',
       '$129.5M', '$93.5M', '$75K', '$7.2M', '$164.5M', '$35.4M', '$3.3M',
       '$500K', '$10.7M', '$151.4M', '$97.5M', '$112M', 'â‚¬6M', 'â‚¬8M',
       '$13.4M', '$83.5M', 'â‚¬4.5M', '$12.2M', '$23.8M', '$156.6M',
       '$165.7M', '$173.6M', '$286.5M', '$312.5M', '$51.9M', '$269.5M',
       '$8.6M', '$22.1M', '$66.9M', '$325M', '$96.1M', 'â‚¬3.5M',
       'DKK10M', '$148M', '$693.5M', '$350K', '$289M', '$301.4M', '$3.5M',
       '$97.1M', '$112.3M', '$221.1M', '$179.1M', '$16.6M', '$233M',
       '$283.7M', '$763.3M', '$294.6M', 'â‚¬1.2M', '$71.5M', '$23.3M',
       '$5.5M', 'CA$3M', '$68.4M', '$115M', '$28.6M', '$177.7M',
       '$467.4M', '$98.2M', '$294M', '$1M', '$244.6M', '$88.1M', '$293M',
       '$47.3M', '$10.4M', '$15.8M', '$700M', '$2.7M', '$123M', '$150K',
       '$26.8M', '$236.4M', '$1.7M', '$225M', '$32.1M', '$178.4M',
       '$122.4M', '$281M', '$110.7M', '$54.4M', '$31.9M', '$268.5M',
       '$16.5B', 'CHF1.8M', '$55.3M', '$120M', '$532.2M', 'NZ$2.3M',
       '$67.4M', '$190.9M', '$60.5M', 'â‚¬550K', '$212.9M', '$25.6M',
       '$3.4M', '$1.8M', '$877.7M', '$103.1M', '$42.6M', '$60.7M',
       '$47.6M', '$243.8K', '$140.4M', '$70.4M', '$26.1M', '$294.1M',
       '$73M', '$737.5M', '$452.5M', '$197.3K', '$608.3M', '$3.2M',
       '$39.4M', '$181M', '$347M', '$24.1M', '$71.8M', '$137.6M',
       '$24.7M', '$17.5M', '$296.3M', '$7.6M', '$16.3M', '$93.7M',
       '$6.2M', '$92M', '$29M', '$193M', '$21.2M', '$743M', '$74.6M',
       '$48.1M', 'â‚¬500K', '$22.5M', '$37.6M', '$159.5M', '$67.9M',
       '$260K', '$637.8K', '$23.4M', '$359.6M', '$150.5K', '$10.8M',
       '$213.5M', '$162.9M', '$511.1M', '$86.3M', '$270.4M', '$63.3M',
       '$173.7M', '$27.7M', '$422.9M', '$219.7M', '$54.7M', '$333.2M',
       '$50.4M', '$3.9B', '$289.2M', '$41.2M']



for pos in l:
    print(pos)
    print(convert_to_int(pos))