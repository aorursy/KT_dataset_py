#import packages
import csv
import igraph as ig
import pandas as pd
import random
import matplotlib.pyplot as plt
%matplotlib inline
#import dataset
Network_Chicago = ig.Graph.Read_Ncol("chicago.txt", directed = False)
Network_Chicago2 = ig.Graph.Read_Ncol("chicago.txt", directed = False)
clusters = pd.read_csv('Chicago_clustering_output_sorted.csv')
del clusters['Node']
clusters = clusters.label.tolist()
print('The unique values of clusters:')
set(clusters)
#pair labels for each node
cluster_0 = []
cluster_1 = []
cluster_2 = []
cluster_3 = []
cluster_4 = []
for ids, k in enumerate(clusters):
    if k == 0:
        cluster_0.append(ids)
    elif k == 1:
        cluster_1.append(ids)
    elif k == 2:
        cluster_2.append(ids)
    elif k == 3:
        cluster_3.append(ids)
    else:
        cluster_4.append(ids)
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs_random = []
for v in range(vcount):
    list_vs_random.append(v)
delete_list = []
for d in range(len(cluster_1)):
    d = d/vcount
    delete_list.append(d)
diameter_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
density_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_density = Network_Chicago_sample.density()
    density_list.append(Network_Chicago_sample_density)
print('-------------------------------------------')
print("Figure: Random Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
plt.plot(delete_list,diameter_list,linestyle='--', marker='o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
plt.plot(delete_list,density_list,linestyle='--', marker='o')
plt.show()
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs = []
list_vs_1 = []
for v in range(vcount):
    list_vs.append(v)
for v in cluster_1:
    list_vs_1.append(v)
diameter_list = []
for i in list_vs_1:
    list_vs.remove(i)
    remaining_nodes = list_vs
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in remaining_nodes])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago,Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
list_vs2 = []
list_vs_2 = []
for v in range(vcount):
    list_vs2.append(v)
for v in cluster_1:
    list_vs_2.append(v)
density_list = []
for i in list_vs_2:
    list_vs2.remove(i)
    remaining_nodes2 = list_vs2
    Network_Chicago2_sample_vs = Network_Chicago2.vs.select([v.index for v in Network_Chicago2.vs if v.index in remaining_nodes2])
    Network_Chicago2_sample = ig.Graph.subgraph(Network_Chicago2,Network_Chicago2_sample_vs)
    Network_Chicago2_sample_density = Network_Chicago2_sample.density()
    density_list.append(Network_Chicago2_sample_density)
num_node = range(len(cluster_1))
print('-------------------------------------------')
print("Figure: Targeted Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
Diameter = pd.DataFrame({'Nodes_Deleted':num_node,'Diameter':diameter_list})
plt.plot(Diameter['Nodes_Deleted']/Network_Chicago.vcount(),Diameter['Diameter'],linestyle='--',marker = 'o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
Density = pd.DataFrame({'Nodes_Deleted':num_node,'Density':density_list})
Density = Density.fillna(0)
plt.plot(Density['Nodes_Deleted']/Network_Chicago2.vcount(),Density['Density'],linestyle='--',marker = 'o')
plt.show()
num_colors = len(Network_Chicago_sample.degree())
palette = ig.GradientPalette('darkblue','skyblue',num_colors)
color_list = []
for i in range(num_colors):
    color_list.append(palette.get(i))
print('----------------------------------------------------------')
print("Figure: Chicago's Subway Network After Deletion of Class 1")
print('----------------------------------------------------------')
ig.plot(Network_Chicago_sample,bbox=(400,300),vertex_color = color_list, vertex_size = 5, layout = 'kamada_kawai')
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs_random = []
for v in range(vcount):
    list_vs_random.append(v)
delete_list = []
for d in range(len(cluster_2)):
    d = d/vcount
    delete_list.append(d)
diameter_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
density_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_density = Network_Chicago_sample.density()
    density_list.append(Network_Chicago_sample_density)
print('-------------------------------------------')
print("Figure: Random Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
plt.plot(delete_list,diameter_list,linestyle='--', marker='o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
plt.plot(delete_list,density_list,linestyle='--', marker='o')
plt.show()
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs = []
list_vs_1 = []
for v in range(vcount):
    list_vs.append(v)
for v in cluster_2:
    list_vs_1.append(v)
diameter_list = []
for i in list_vs_1:
    list_vs.remove(i)
    remaining_nodes = list_vs
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in remaining_nodes])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago,Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
list_vs2 = []
list_vs_2 = []
for v in range(vcount):
    list_vs2.append(v)
for v in cluster_2:
    list_vs_2.append(v)
density_list = []
for i in list_vs_2:
    list_vs2.remove(i)
    remaining_nodes2 = list_vs2
    Network_Chicago2_sample_vs = Network_Chicago2.vs.select([v.index for v in Network_Chicago2.vs if v.index in remaining_nodes2])
    Network_Chicago2_sample = ig.Graph.subgraph(Network_Chicago2,Network_Chicago2_sample_vs)
    Network_Chicago2_sample_density = Network_Chicago2_sample.density()
    density_list.append(Network_Chicago2_sample_density)
num_node = range(len(cluster_2))
print('-------------------------------------------')
print("Figure: Targeted Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
Diameter = pd.DataFrame({'Nodes_Deleted':num_node,'Diameter':diameter_list})
plt.plot(Diameter['Nodes_Deleted']/Network_Chicago.vcount(),Diameter['Diameter'],linestyle='--',marker = 'o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
Density = pd.DataFrame({'Nodes_Deleted':num_node,'Density':density_list})
Density = Density.fillna(0)
plt.plot(Density['Nodes_Deleted']/Network_Chicago2.vcount(),Density['Density'],linestyle='--',marker = 'o')
plt.show()
num_colors = len(Network_Chicago_sample.degree())
palette = ig.GradientPalette('darkblue','skyblue',num_colors)
color_list = []
for i in range(num_colors):
    color_list.append(palette.get(i))
print('----------------------------------------------------------')
print("Figure: Chicago's Subway Network After Deletion of Class 2")
print('----------------------------------------------------------')
ig.plot(Network_Chicago_sample,bbox=(400,300),vertex_color = color_list, vertex_size = 5, layout = 'kamada_kawai')
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs_random = []
for v in range(vcount):
    list_vs_random.append(v)
delete_list = []
for d in range(len(cluster_4)):
    d = d/vcount
    delete_list.append(d)
diameter_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
density_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_density = Network_Chicago_sample.density()
    density_list.append(Network_Chicago_sample_density)
print('-------------------------------------------')
print("Figure: Random Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
plt.plot(delete_list,diameter_list,linestyle='--', marker='o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
plt.plot(delete_list,density_list,linestyle='--', marker='o')
plt.show()
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs = []
list_vs_1 = []
for v in range(vcount):
    list_vs.append(v)
for v in cluster_4:
    list_vs_1.append(v)
diameter_list = []
for i in list_vs_1:
    list_vs.remove(i)
    remaining_nodes = list_vs
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in remaining_nodes])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago,Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
list_vs2 = []
list_vs_2 = []
for v in range(vcount):
    list_vs2.append(v)
for v in cluster_4:
    list_vs_2.append(v)
density_list = []
for i in list_vs_2:
    list_vs2.remove(i)
    remaining_nodes2 = list_vs2
    Network_Chicago2_sample_vs = Network_Chicago2.vs.select([v.index for v in Network_Chicago2.vs if v.index in remaining_nodes2])
    Network_Chicago2_sample = ig.Graph.subgraph(Network_Chicago2,Network_Chicago2_sample_vs)
    Network_Chicago2_sample_density = Network_Chicago2_sample.density()
    density_list.append(Network_Chicago2_sample_density)
num_node = range(len(cluster_4))
print('-------------------------------------------')
print("Figure: Targeted Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
Diameter = pd.DataFrame({'Nodes_Deleted':num_node,'Diameter':diameter_list})
plt.plot(Diameter['Nodes_Deleted']/Network_Chicago.vcount(),Diameter['Diameter'],linestyle='--',marker = 'o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
Density = pd.DataFrame({'Nodes_Deleted':num_node,'Density':density_list})
Density = Density.fillna(0)
plt.plot(Density['Nodes_Deleted']/Network_Chicago2.vcount(),Density['Density'],linestyle='--',marker = 'o')
plt.show()
num_colors = len(Network_Chicago_sample.degree())
palette = ig.GradientPalette('darkblue','skyblue',num_colors)
color_list = []
for i in range(num_colors):
    color_list.append(palette.get(i))
print('----------------------------------------------------------')
print("Figure: Chicago's Subway Network After Deletion of Class 3")
print('----------------------------------------------------------')
ig.plot(Network_Chicago_sample,bbox=(400,300),vertex_color = color_list, vertex_size = 5, layout = 'kamada_kawai')
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs_random = []
for v in range(vcount):
    list_vs_random.append(v)
delete_list = []
for d in range(len(cluster_3)):
    d = d/vcount
    delete_list.append(d)
diameter_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
density_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_density = Network_Chicago_sample.density()
    density_list.append(Network_Chicago_sample_density)
print('-------------------------------------------')
print("Figure: Random Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
plt.plot(delete_list,diameter_list,linestyle='--', marker='o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
plt.plot(delete_list,density_list,linestyle='--', marker='o')
plt.show()
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs = []
list_vs_1 = []
for v in range(vcount):
    list_vs.append(v)
for v in cluster_3:
    list_vs_1.append(v)
diameter_list = []
for i in list_vs_1:
    list_vs.remove(i)
    remaining_nodes = list_vs
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in remaining_nodes])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago,Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
list_vs2 = []
list_vs_2 = []
for v in range(vcount):
    list_vs2.append(v)
for v in cluster_3:
    list_vs_2.append(v)
density_list = []
for i in list_vs_2:
    list_vs2.remove(i)
    remaining_nodes2 = list_vs2
    Network_Chicago2_sample_vs = Network_Chicago2.vs.select([v.index for v in Network_Chicago2.vs if v.index in remaining_nodes2])
    Network_Chicago2_sample = ig.Graph.subgraph(Network_Chicago2,Network_Chicago2_sample_vs)
    Network_Chicago2_sample_density = Network_Chicago2_sample.density()
    density_list.append(Network_Chicago2_sample_density)
num_node = range(len(cluster_3))
print('-------------------------------------------')
print("Figure: Targeted Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
Diameter = pd.DataFrame({'Nodes_Deleted':num_node,'Diameter':diameter_list})
plt.plot(Diameter['Nodes_Deleted']/Network_Chicago.vcount(),Diameter['Diameter'],linestyle='--',marker = 'o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
Density = pd.DataFrame({'Nodes_Deleted':num_node,'Density':density_list})
Density = Density.fillna(0)
plt.plot(Density['Nodes_Deleted']/Network_Chicago2.vcount(),Density['Density'],linestyle='--',marker = 'o')
plt.show()
num_colors = len(Network_Chicago_sample.degree())
palette = ig.GradientPalette('darkblue','skyblue',num_colors)
color_list = []
for i in range(num_colors):
    color_list.append(palette.get(i))
print('----------------------------------------------------------')
print("Figure: Chicago's Subway Network After Deletion of Class 4")
print('----------------------------------------------------------')
ig.plot(Network_Chicago_sample,bbox=(400,300),vertex_color = color_list, vertex_size = 5, layout = 'kamada_kawai')
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs_random = []
for v in range(vcount):
    list_vs_random.append(v)
delete_list = []
for d in range(len(cluster_0)):
    d = d/vcount
    delete_list.append(d)
diameter_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
density_list = []
for i,inx in enumerate(delete_list):
    sample = random.sample(list_vs_random, vcount-i)
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in sample])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago, Network_Chicago_sample_vs)
    Network_Chicago_sample_density = Network_Chicago_sample.density()
    density_list.append(Network_Chicago_sample_density)
print('-------------------------------------------')
print("Figure: Random Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
plt.plot(delete_list,diameter_list,linestyle='--', marker='o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
plt.plot(delete_list,density_list,linestyle='--', marker='o')
plt.show()
ecount = Network_Chicago.ecount()#edges
vcount = Network_Chicago.vcount()#nodes
list_vs = []
list_vs_1 = []
for v in range(vcount):
    list_vs.append(v)
for v in cluster_0:
    list_vs_1.append(v)
diameter_list = []
for i in list_vs_1:
    list_vs.remove(i)
    remaining_nodes = list_vs
    Network_Chicago_sample_vs = Network_Chicago.vs.select([v.index for v in Network_Chicago.vs if v.index in remaining_nodes])
    Network_Chicago_sample = ig.Graph.subgraph(Network_Chicago,Network_Chicago_sample_vs)
    Network_Chicago_sample_diameter = Network_Chicago_sample.diameter()
    diameter_list.append(Network_Chicago_sample_diameter)
list_vs2 = []
list_vs_2 = []
for v in range(vcount):
    list_vs2.append(v)
for v in cluster_0:
    list_vs_2.append(v)
density_list = []
for i in list_vs_2:
    list_vs2.remove(i)
    remaining_nodes2 = list_vs2
    Network_Chicago2_sample_vs = Network_Chicago2.vs.select([v.index for v in Network_Chicago2.vs if v.index in remaining_nodes2])
    Network_Chicago2_sample = ig.Graph.subgraph(Network_Chicago2,Network_Chicago2_sample_vs)
    Network_Chicago2_sample_density = Network_Chicago2_sample.density()
    density_list.append(Network_Chicago2_sample_density)
num_node = range(len(cluster_0))
print('-------------------------------------------')
print("Figure: Targeted Deletion on Chicago's Subway Network")
print('-------------------------------------------')
plt.subplot(211)
plt.title('Deletion Influence')
plt.xlabel('Fraction of deleted node')
plt.ylabel('Diameter')
Diameter = pd.DataFrame({'Nodes_Deleted':num_node,'Diameter':diameter_list})
plt.plot(Diameter['Nodes_Deleted']/Network_Chicago.vcount(),Diameter['Diameter'],linestyle='--',marker = 'o')
plt.subplot(212)
plt.xlabel('Fraction of deleted node')
plt.ylabel('Density')
Density = pd.DataFrame({'Nodes_Deleted':num_node,'Density':density_list})
Density = Density.fillna(0)
plt.plot(Density['Nodes_Deleted']/Network_Chicago2.vcount(),Density['Density'],linestyle='--',marker = 'o')
plt.show()
num_colors = len(Network_Chicago_sample.degree())
palette = ig.GradientPalette('darkblue','skyblue',num_colors)
color_list = []
for i in range(num_colors):
    color_list.append(palette.get(i))
print('----------------------------------------------------------')
print("Figure: Chicago's Subway Network After Deletion of Class 5")
print('----------------------------------------------------------')
ig.plot(Network_Chicago_sample,bbox=(400,300),vertex_color = color_list, vertex_size = 5, layout = 'kamada_kawai')