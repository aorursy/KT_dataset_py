import numpy as np # linear algebra
import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)
from sklearn.linear_model import LogisticRegression
train = pd.read_csv("../input/train.csv")
test = pd.read_csv("../input/test.csv")
print(train.head())
train.head()
test.head()
drop_train = train.drop(['PassengerId','Name','Ticket','Cabin'], axis=1)
drop_test = test.drop(['PassengerId','Name','Ticket','Cabin'], axis=1)
drop_train.head()
drop_test.head()
X_train = drop_train.drop(['Survived'], axis=1)
X_train.head()
Y_train = drop_train.drop(['Pclass','Sex','Age','SibSp','Parch','Fare','Embarked'],axis=1)
Y_train.head()
oneHot_X_train = pd.get_dummies(X_train)
oneHot_X_train.head()
oneHot_X_train = pd.get_dummies(X_train, columns=['Pclass','Sex','Embarked'])
oneHot_X_train.head()
oneHot_test = pd.get_dummies(drop_test, columns=['Pclass','Sex','Embarked'])
oneHot_test.head()
print(oneHot_X_train.isnull().sum())
print(oneHot_test.isnull().sum())
from sklearn.preprocessing import Imputer
my_imputer = Imputer()
imputer_X_train = my_imputer.fit_transform(oneHot_X_train)
imputer_test = my_imputer.fit_transform(oneHot_test)                              
print(type(imputer_X_train))
print(imputer_X_train.shape)
print(imputer_X_train[0:5,])
print(type(imputer_test))
print(imputer_test.shape)
print(imputer_test[0:5,])
lr = LogisticRegression().fit(imputer_X_train, Y_train)
print(lr.score(imputer_X_train,Y_train))
print(Y_train.shape)
reshaped_Y_train = Y_train.values.ravel()
print(reshaped_Y_train.shape)
lr = LogisticRegression().fit(imputer_X_train, reshaped_Y_train)
print(lr.score(imputer_X_train, reshaped_Y_train))
test_pred = lr.predict(imputer_test)
print(test_pred.shape)
print(test_pred[0:5,])
submission = pd.DataFrame({
    "PassengerId": test["PassengerId"],
    "Survived": test_pred
})
submission.head()
submission.to_csv('submission.csv', index=False)